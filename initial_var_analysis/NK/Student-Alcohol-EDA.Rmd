---
title: "Student Alcohol EDA"
author: "Nabhan Kamarudzman"
date: "11/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(dplyr)
library("gridExtra") 
```

## Data with Main Columns for EDA

```{r}
students <- read.csv("student-mat.csv")
main_cols <- students %>% select("Dalc", "Walc", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob")
head(main_cols)
```

## Pstatus

"A" resembles parents that stay apart (or a single parent), and "T" resembles parents that live together.

```{r}

p1 <- ggplot(data=main_cols, mapping=aes(x=Pstatus, y=Dalc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Parent Status") + xlab("Parent Status") + ylab("Weekday Consumption Level") +
  scale_x_discrete(labels= c("Alone", "Together"))

p2 <- ggplot(data=main_cols, mapping=aes(x=Pstatus, y=Walc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Parent Status") + xlab("Parent Status") + ylab("Weekend Consumption Level") +
  scale_x_discrete(labels= c("Alone", "Together"))

grid.arrange(p1, p2, ncol = 2)

```

From this we can see that on Weekends, there is higher frequency of alcohol consumption for students who's parents live alone.

```{r}

main_cols %>% 
  group_by(Pstatus) %>% 
  summarize(count=n())

Pstatus_EDA1 <- main_cols %>% 
  group_by(Pstatus, Dalc) %>% 
  summarize(count=n(), .groups="drop") %>%
  mutate(total=case_when(Pstatus=="A"~41, 
                         Pstatus=="T"~354)) %>% 
  mutate(prop=count/total)

p1 <- ggplot(Pstatus_EDA1, aes(x=Dalc, y=prop, fill=Pstatus)) + geom_col(position="dodge") + ggtitle("Proportion of Students\nby Parent Status") + 
  xlab("Weekday Consumption Level") + ylab("Proportion") +
  scale_fill_discrete(name="Parent Status",
                         breaks=c("A", "T"),
                         labels=c("Alone", "Together"))

Pstatus_EDA2 <- main_cols %>% 
  group_by(Pstatus, Walc) %>% 
  summarize(count=n(), .groups="drop") %>%
  mutate(total=case_when(Pstatus=="A"~41, 
                         Pstatus=="T"~354)) %>% 
  mutate(prop=count/total)

p2 <- ggplot(Pstatus_EDA2, aes(x=Walc, y=prop, fill=Pstatus)) + geom_col(position="dodge") + ggtitle("Proportion of Students\nby Parent Status") + 
  xlab("Weekend Consumption Level") + ylab("Proportion") +
  scale_fill_discrete(name="Parent Status",
                         breaks=c("A", "T"),
                         labels=c("Alone", "Together"))

grid.arrange(p1, p2, ncol = 2)

```

There is a general decrease in alcohol consumption for both weekdays and weekends, but it it seems that the highest and the lowest proportions of weekend alcohol consumption belongs to students whose parents live alone.

## Mother's Education

```{r}

p1 <- ggplot(main_cols, aes(x = as.factor(Medu), y = Dalc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Mother's Education") + xlab("Mother's Education") + ylab("Weekday Consumption Level")

p2 <- ggplot(main_cols, aes(x = as.factor(Medu), y = Walc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Mother's Education") + xlab("Mother's Education") + ylab("Weekend Consumption Level") 

grid.arrange(p1, p2, ncol = 2)

```

For weekday consumption levels, all mother's education seem to project low alcohol consumption levels but with a few outliers. For weekend consumption levels, the highest frequencies belong to the lowest Mother's education.

```{r}

p1 <- ggplot(main_cols, mapping=aes(x=Dalc)) +
  geom_bar(aes(fill=as.factor(Medu)),position="dodge") + 
  ggtitle("Count of Students\nby Mother's Education") + 
  xlab("Weekday Consumption Level") + ylab("Count") +
  scale_fill_discrete(name="Mother's Education")

p2 <- ggplot(main_cols, mapping=aes(x=Walc)) +
  geom_bar(aes(fill=as.factor(Medu)),position="dodge") + 
  ggtitle("Count of Students\nby Mother's Education") + 
  xlab("Weekend Consumption Level") + ylab("Count") +
  scale_fill_discrete(name="Mother's Education")

grid.arrange(p1, p2, ncol = 2)

```

Generally, the lowest counts of consumption levels for both weekdays and weekends belong to Mother's with the highest education level.

## Father's Education

```{r}

p1 <- ggplot(main_cols, aes(x = as.factor(Fedu), y = Dalc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Father's Education") + xlab("Father's Education") + ylab("Weekday Consumption Level") 

p2 <- ggplot(main_cols, aes(x = as.factor(Fedu), y = Walc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Father's Education") + xlab("Father's Education") + ylab("Weekend Consumption Level") 

grid.arrange(p1, p2, ncol = 2)

```

There are a lot of outliers in the frequency of weekday alcohol consumption given Father's level of education. Generally, the frequencies are equal for all (except no education) levels of Father's education.

```{r}

p1 <- ggplot(main_cols, mapping=aes(x=Dalc)) +
  geom_bar(aes(fill=as.factor(Fedu)),position="dodge") + 
  ggtitle("Count of Students\nby Father's Education") + 
  xlab("Weekday Consumption Level") + ylab("Count") +
  scale_fill_discrete(name="Father's Education")

p2 <- ggplot(main_cols, mapping=aes(x=Walc)) +
  geom_bar(aes(fill=as.factor(Fedu)),position="dodge") + 
  ggtitle("Count of Students\nby Father's Education") + 
  xlab("Weekend Consumption Level") + ylab("Count") +
  scale_fill_discrete(name="Father's Education")

grid.arrange(p1, p2, ncol = 2)

```

There are high number of low weekday and weekend alcohol consumption levels for middle-tiered education of the Father's, but high alcohol consumptions on the weekends for Fathers with the highest level of education.

## Mother's Job

```{r}

p1 <- ggplot(data=main_cols, mapping=aes(x=Mjob, y=Dalc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Mother's Job") + xlab("Mother's Job") + ylab("Weekday Consumption Level")

p2 <- ggplot(data=main_cols, mapping=aes(x=Mjob, y=Walc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Mother's Job") + xlab("Mother's Job") + ylab("Weekend Consumption Level")

grid.arrange(p1, p2, ncol = 2)

```

There is low frequency of weekday alcohol consumption for students whose Mother's job is health, but higher average frequency levels of weekend alcohol consumption for students whose Mother's job is health.

```{r}
main_cols %>% 
  group_by(Mjob) %>% 
  summarize(count=n())

Mjob_EDA1 <- main_cols %>% 
  group_by(Mjob, Dalc) %>% 
  summarize(count=n(), .groups="drop") %>%
  mutate(total=case_when(Mjob=="at_home"~59, 
                         Mjob=="health"~34,
                         Mjob=="other"~141,
                         Mjob=="services"~103, 
                         Mjob=="teacher"~58)) %>% 
  mutate(prop=count/total)

p1 <- ggplot(Mjob_EDA1, aes(x=Dalc, y=prop, fill=Mjob)) + geom_col(position="dodge") + ggtitle("Proportion of Students\nby Mother's Job") + 
  xlab("Weekday Consumption Level") + ylab("Proportion") +
  scale_fill_discrete(name="Mother's Job")

Mjob_EDA2 <- main_cols %>% 
  group_by(Mjob, Walc) %>% 
  summarize(count=n(), .groups="drop") %>%
  mutate(total=case_when(Mjob=="at_home"~59, 
                         Mjob=="health"~34,
                         Mjob=="other"~141,
                         Mjob=="services"~103, 
                         Mjob=="teacher"~58)) %>% 
  mutate(prop=count/total)


p2 <- ggplot(Mjob_EDA2, aes(x=Walc, y=prop, fill=Mjob)) + geom_col(position="dodge") + ggtitle("Proportion of Students\nby Mother's Job") + 
  xlab("Weekend Consumption Level") + ylab("Proportion") +
  scale_fill_discrete(name="Mother's Job")

grid.arrange(p1, p2, ncol = 2)
```

There is higher weekend alcohol consumption levels for students whose Mother's job are at home, but also lower weekend alcohol consumption levels (in comparison to other jobs).

## Father's Job

```{r}

p1 <- ggplot(data=main_cols, mapping=aes(x=Fjob, y=Dalc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Father's Job") + xlab("Father's Job") + ylab("Weekday Consumption Level")

p2 <- ggplot(data=main_cols, mapping=aes(x=Fjob, y=Walc)) +
  geom_boxplot() + ggtitle("Frequency of Consumption Level\nby Father's Job") + xlab("Father's Job") + ylab("Weekend Consumption Level")

grid.arrange(p1, p2, ncol = 2)

```

The frequency is highest for students whose Father's job are others and services for weekend alcohol consumption.

```{r}

main_cols %>% 
  group_by(Fjob) %>% 
  summarize(count=n())

Fjob_EDA1 <- main_cols %>% 
  group_by(Fjob, Dalc) %>% 
  summarize(count=n(), .groups="drop") %>%
  mutate(total=case_when(Fjob=="at_home"~20, 
                         Fjob=="health"~18,
                         Fjob=="other"~217,
                         Fjob=="services"~111, 
                         Fjob=="teacher"~29)) %>% 
  mutate(prop=count/total)


p1 <- ggplot(Fjob_EDA1, aes(x=Dalc, y=prop, fill=Fjob)) + geom_col(position="dodge") + ggtitle("Proportion of Students\nby Father's Job") + 
  xlab("Weekday Consumption Level") + ylab("Proportion") +
  scale_fill_discrete(name="Father's Job")

Fjob_EDA2 <- main_cols %>% 
  group_by(Fjob, Walc) %>% 
  summarize(count=n(), .groups="drop") %>%
  mutate(total=case_when(Fjob=="at_home"~20, 
                         Fjob=="health"~18,
                         Fjob=="other"~217,
                         Fjob=="services"~111, 
                         Fjob=="teacher"~29)) %>% 
  mutate(prop=count/total)

p2 <- ggplot(Fjob_EDA2, aes(x=Walc, y=prop, fill=Fjob)) + geom_col(position="dodge") + ggtitle("Proportion of Students\nby Father's Job") + 
  xlab("Weekend Consumption Level") + ylab("Proportion") +
  scale_fill_discrete(name="Father's Job")

grid.arrange(p1, p2, ncol = 2)
```

The highest proportion for lowest weekend alcohol consumption level belongs to students whose Father works in health, but highest weekend alcohol consumption level belongs to students whose Father works in services.
